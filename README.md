# 智能分类垃圾桶 - 2024工程实践与创新能力大赛作品

本项目是为2024年工程实践与创新能力大赛开发的智能分类垃圾桶系统，基于STM32F407ZGT6微控制器，采用FreeRTOS实时操作系统，实现垃圾自动识别、分类和存储功能。

## 项目概述

智能分类垃圾桶能够自动识别用户投放的垃圾类型，并将垃圾送入对应的分类存储箱中。系统通过视觉识别技术判断垃圾类别，结合机械结构实现垃圾的自动分类投放，提高垃圾分类效率和准确性。

## 系统功能

### 核心功能
- **垃圾自动识别**：通过视觉识别系统对垃圾进行分类识别
- **四类垃圾分类**：
  1. 可回收垃圾
  2. 其他垃圾
  3. 厨余垃圾
  4. 有害垃圾
- **自动分拣**：通过舵机云台和步进电机驱动机械结构将垃圾送入对应存储箱
- **满载检测**：通过超声波传感器检测各分类箱的填充状态
- **统计功能**：实时统计各类垃圾投放数量

### 硬件组成
- **主控芯片**：STM32F407ZGT6
- **识别模块**：视觉识别系统（通过串口通信）
- **执行机构**：
  - 舵机云台：用于垃圾导向
  - 步进电机：驱动传送带等机械结构
- **传感器模块**：
  - 光电开关：检测垃圾投放动作
  - 超声波传感器：检测垃圾桶满载状态
- **通信接口**：UART、DMA

## 软件架构

### 开发环境
- STM32CubeIDE / Keil MDK-ARM
- HAL库
- FreeRTOS实时操作系统

### 主要软件模块

1. **视觉识别模块** ([app_visual_identity.c](Drivers/App/Src/app_visual_identity.c))
   - 垃圾类型识别与稳定性判断
   - 投放统计与状态管理

2. **舵机控制模块** ([app_servo_motor.c](Drivers/App/Src/app_servo_motor.c))
   - 控制舵机云台转动
   - 根据垃圾类型将垃圾导向对应分类箱

3. **步进电机控制模块** ([app_stepper_motor.c](Drivers/App/Src/app_stepper_motor.c))
   - 控制传送带等机械结构
   - 实现垃圾的物理传送

4. **传感器检测模块**
   - 光电开关模块 ([app_OPTO_switch.c](Drivers/App/Src/app_OPTO_switch.c))：检测垃圾投放
   - 超声波传感器模块 ([app_sonar.c](Drivers/App/Src/app_sonar.c))：检测垃圾桶满载状态

5. **通信模块** ([UART_DMA.c](Drivers/App/Src/UART_DMA.c))
   - 实现与视觉识别模块的数据通信

### 任务调度

系统基于FreeRTOS实现多任务调度：
- 视觉识别任务
- 舵机控制任务
- 步进电机控制任务
- 传感器检测任务
- 超声波检测任务

## 系统工作流程

1. 用户投放垃圾
2. 光电开关检测到垃圾投放动作
3. 启动视觉识别系统进行垃圾类型识别
4. 识别结果稳定后，系统控制相应舵机转动
5. 步进电机驱动传送带将垃圾送入对应分类箱
6. 超声波传感器实时检测各分类箱满载状态
7. 系统统计各类垃圾投放数量

## 文件结构

```
.
├── Core/                 # 核心代码
│   ├── Inc/              # 头文件
│   └── Src/              # 源代码
├── Drivers/              # 驱动程序
│   ├── App/              # 应用层驱动
│   │   ├── Inc/
│   │   └── Src/
│   ├── KMDriver/         # 硬件驱动
│   └── STM32F4xx_HAL_Driver/  # HAL库驱动
├── Middlewares/          # 中间件（FreeRTOS）
└── MDK-ARM/              # Keil项目文件
```

## 使用说明

1. 硬件连接：
   - 确保所有传感器、执行器正确连接到主控板
   - 连接视觉识别模块到指定UART接口

2. 编译下载：
   - 使用Keil MDK-ARM或STM32CubeIDE编译项目
   - 将程序下载到STM32F407ZGT6开发板

3. 运行操作：
   - 上电后系统自动初始化
   - 投放垃圾后系统自动进行识别和分拣

## 注意事项

- 定期清理传感器，确保检测准确性
- 注意检查机械结构运行状态
- 及时清空满载的分类箱

## 维护与扩展

系统采用模块化设计，便于功能扩展和维护。可根据需要添加新的垃圾类别或改进识别算法。
